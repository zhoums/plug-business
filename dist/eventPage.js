!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.app_version="1.1.5",t.app_verSeq=2,t.default={checkPlugCookie:"check-plug-cookie",tbPlatform:"https://we.taobao.com/",backEndHost_dev:"http://spider.ittun.com/spider",backEndHost_pro:"http://47.107.35.8:8281/spider",max_interval:80,min_interval:25}},function(e,t,n){"use strict";s(n(0));var r=n(2),o=s(r),a=n(3);function s(e){return e&&e.__esModule?e:{default:e}}function u(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}chrome.webRequest.onBeforeSendHeaders.addListener(function(e){if("xmlhttprequest"===e.type){for(var t=!1,n=0;n<e.requestHeaders.length;++n)if("Referer"===e.requestHeaders[n].name){t=!0,e.requestHeaders[n].value="https://we.taobao.com/";break}return t||e.requestHeaders.push({name:"Referer",value:"https://we.taobao.com/"}),{requestHeaders:e.requestHeaders}}},{urls:["https://*.taobao.com/*"]},["blocking","requestHeaders"]);var i=void 0,c=void 0,f=0,l=function(e,t,n,s){var u=4<arguments.length&&void 0!==arguments[4]?arguments[4]:1,i=5<arguments.length&&void 0!==arguments[5]?arguments[5]:50;return(0,r.getDateRange)(10),(0,r.getDateRange)(2),$.ajax({url:a.moli_host+"/mer/getContentIdsByShop.wb",async:!1,headers:{version:"1.0.0",vs:"1",tk:s},data:{page:u,pageSize:i,shopId:e,loginUserId:t,mainUserId:n},success:function(e){0===e.status?(f=e.result.contetnIds.length,e.result.contetnIds.forEach(function(r,a){var u,i,c,f;(u=r,i=e.result.dateFrom,c=e.result.dateTo,f=o.default.generatTk(9),new Promise(function(e,t){$.ajax({url:"https://sycm.taobao.com/xsite/content/single/detail/result.json?dateType=range&dateRange="+i+"%7C"+c+"&indexCode=&contentId="+u+"&_=1541740203285&token="+f,success:function(n){n.hasError?t(n.content.message):e(n.content.data)},faile:function(){t("系统出错，未知异常")}})})).then(function(e){d(t,n,e,s)})})):f=0}}),[]},d=function(e,t,n,r){var o=[];o.push(n),$.ajax({url:a.moli_host+"/mer/syncMerEffect.wb",contentType:"application/json",headers:{version:"1.0.0",vs:"1",tk:r},type:"post",data:JSON.stringify({loginUserId:e,mainUserId:t,itemList:o}),success:function(e){console.log(e)}})};chrome.runtime.onMessage.addListener(function(e,t,n){if("business"==e.greeting){var r=e.tk,s=e.shopId;new Promise(function(e,t){$.ajax({url:"https://sycm.taobao.com/custom/menu/getPersonalView.json?token="+o.default.generatTk(9),success:function(n){0===n.code?e(n.data):t(n.msg)},faile:function(){t("获取用户信息失败")}})}).then(function(e){var t,n;c=e.loginUserId,i=e.mainUserId,(t=e,n=r,new Promise(function(e,r){$.ajax({url:a.moli_host+"/mer/syncPersonalInfo.wb",type:"post",headers:{version:"1.1.4",vs:"1",tk:n},data:t,success:function(t){0===t.status?e():r(),console.log(t)}})})).then(function(e){var t=[],n=l(s,c,i,r);t=[].concat(u(t),u(n));for(var a=2;0<f;){var d=l(s,c,i,r,a);t=[].concat(u(t),u(d)),a++,o.default.sleep(80*Math.random()+20)}}).catch(function(){alert("同步商家信息出错。")})}).catch(function(e){alert("请先登录生意参谋。"),console.log("catch:",e)})}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={$http:function(e,t){return new Promise(function(n,r){var o=new XMLHttpRequest;o.open(e,t,!0),o.onreadystatechange=function(){if(4==o.readyState){var e=JSON.parse(o.responseText);n(e)}},o.send()})},generatTk:function(e,t){t=t||"abcdefghijklmnopqrstuvwxyz0123456789";for(var n="",r=0;r<e;r++){var o=Math.floor(Math.random()*t.length);n+=t.substring(o,o+1)}return n},sleep:function(e){for(var t=new Date,n=t.getTime()+e;;)if((t=new Date).getTime()>n)return}},t.getDateRange=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=(new Date).getTime(),n=new Date(t-24*e*60*60*1e3),r=n.getMonth()+1;return r=9<r?r:"0"+r,n.getFullYear()+"-"+r+"-"+n.getDate()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.frontEndHost=t.moli_host=t.versionObj=void 0;var r,o=(r=n(0))&&r.__esModule?r:{default:r};t.versionObj=function(){return new Promise(function(e,t){$.ajax({url:s+"/spider/checkUpdate.wb?vs=1",success:function(t){e(t)},faile:function(e){t(e)}})})};var a,s=void 0;t.moli_host=s=o.default.backEndHost_pro,t.frontEndHost=a=o.default.tbPlatform,t.moli_host=s,t.frontEndHost=a}]);