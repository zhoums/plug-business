{"code":"!function(e){var r={};function t(a){if(r[a])return r[a].exports;var n=r[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,t),n.l=!0,n.exports}t.m=e,t.c=r,t.d=function(e,r,a){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:a})},t.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&\"object\"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(t.r(a),Object.defineProperty(a,\"default\",{enumerable:!0,value:e}),2&r&&\"string\"!=typeof e)for(var n in e)t.d(a,n,function(r){return e[r]}.bind(null,n));return a},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,\"a\",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p=\"\",t(t.s=1)}([function(e,r,t){\"use strict\";Object.defineProperty(r,\"__esModule\",{value:!0}),r.app_version=\"1.1.5\",r.app_verSeq=2,r.default={checkPlugCookie:\"check-plug-cookie\",tbPlatform:\"https://we.taobao.com/\",backEndHost_dev:\"http://spider.ittun.com/spider\",backEndHost_pro:\"http://47.107.35.8:8281/spider\",max_interval:80,min_interval:25}},function(e,r,t){\"use strict\";var a=t(0),n=s(a),o=s(t(2)),i=t(3);function s(e){return e&&e.__esModule?e:{default:e}}function u(e){return function(){var r=e.apply(this,arguments);return new Promise(function(e,t){return function a(n,o){try{var i=r[n](o),s=i.value}catch(n){return void t(n)}if(!i.done)return Promise.resolve(s).then(function(e){a(\"next\",e)},function(e){a(\"throw\",e)});e(s)}(\"next\")})}}console.log(\"background js test\"),alert(678),chrome.webRequest.onBeforeSendHeaders.addListener(function(e){if(\"xmlhttprequest\"===e.type){for(var r=!1,t=0;t<e.requestHeaders.length;++t)if(\"Referer\"===e.requestHeaders[t].name){r=!0,e.requestHeaders[t].value=\"https://we.taobao.com/\";break}return r||e.requestHeaders.push({name:\"Referer\",value:\"https://we.taobao.com/\"}),{requestHeaders:e.requestHeaders}}},{urls:[\"https://*.taobao.com/*\"]},[\"blocking\",\"requestHeaders\"]),(0,i.versionObj)(),chrome.runtime.onMessage.addListener(function(e,r,t){if(\"checkVersion\"==e.greeting&&(0,i.versionObj)().then(function(e){e.result.verSeq>a.app_verSeq&&(chrome.tabs.getSelected(null,function(r){chrome.tabs.sendRequest(r.id,{greeting:\"checkV\",res:e.result},function(e){console.log(e)})}),e.result.app_verSeq=a.app_verSeq,t(e.result))}),\"triggerConfig\"==e.greeting){console.log(\"正在获取配置数据，请稍候。。。\");var s=void 0;$.ajax({url:i.moli_host+\"/spider/config.wb?\"+e.head+\"&version=\"+a.app_version+\"&vs=\"+a.app_verSeq,async:!1,success:function(e){s=e}}),t(s)}\"fetchConfig\"==e.greeting&&t(null),\"spider\"==e.greeting&&e.interFaceList.forEach(function(r,t){var s,l=[],c=[];if(!Array.isArray(r.requestArgs)){var p=Object.assign({},{version:a.app_version,msg:\"request.interFaceList item is not a array - > apiUrl: \"+r.apiUrl});$.ajax({url:i.moli_host+\"/spider/exception.wb\",type:\"POST\",headers:e.head,data:p,success:function(e){console.log(\"has error :  +\",r.apiUrl)}})}r.requestArgs.forEach((s=u(regeneratorRuntime.mark(function t(a,n){var o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:o=Object.assign({},e.head),\"get\"===r.apiMethod?(r.pagerArg&&(a.getArgs.pageParamField={},a.getArgs.pageParamField[r.pagerArg.pageSizeArg]=r.pagerArg.defaultPageSize,a.getArgs.pageParamField[r.pagerArg.pageArg]=1,a.getArgs.pageParamField.totalField=r.pagerArg.totalField,a.getArgs.pageParamField.pageArg=r.pagerArg.pageArg),l.push(a.getArgs),Array.isArray(a.backArgs)&&a.backArgs.forEach(function(e,r){o[e]=a.getArgs[e]})):(r.pagerArg&&(a.postArgs.pageParamField={},a.postArgs.pageParamField[r.pagerArg.pageSizeArg]=r.pagerArg.defaultPageSize,a.postArgs.pageParamField[r.pagerArg.pageArg]=1,a.postArgs.pageParamField.totalField=r.pagerArg.totalField,a.postArgs.pageParamField.pageArg=r.pagerArg.pageArg),l.push(a.postArgs),Array.isArray(a.backArgs)&&a.backArgs.forEach(function(e,r){o[e]=a.postArgs[e]})),r.contentType&&(o[\"Content-Type\"]=r.contentType),c.push(o);case 4:case\"end\":return t.stop()}},t,this)})),function(e,r){return s.apply(this,arguments)})),l.forEach(function(t,s){var l=\"?\",p=null;for(var g in t)\"pageParamField\"==g?p=Object.assign({},t[g]):\"?\"===l?\"syncTime\"!==g&&(l+=g+\"=\"+t[g]):\"syncTime\"!==g&&(l+=\"&\"+g+\"=\"+t[g]);var f,d=(f=u(regeneratorRuntime.mark(function t(){var u,g=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,f=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:u=parseInt(Math.random()*(n.default.max_interval-n.default.min_interval)+n.default.min_interval,10),p&&(1<g&&(p[p.pageArg]=g),Object.keys(p).forEach(function(e,r){if(\"totalField\"!==e&&\"pageArg\"!==e)if(\"?\"===l)l+=e+\"=\"+p[e];else{var t={},a=l.slice(l.indexOf(\"?\")+1).split(\"&\"),n=!0,o=!1,i=void 0;try{for(var s,u=a[Symbol.iterator]();!(n=(s=u.next()).done);n=!0){var c=s.value;t[c.split(\"=\")[0]]=c.split(\"=\")[1]}}catch(e){o=!0,i=e}finally{try{!n&&u.return&&u.return()}finally{if(o)throw i}}t[e]=p[e];var g=[];for(var f in t){var d=encodeURIComponent(f),v=encodeURIComponent(t[f]);g.push(d+\"=\"+v)}l=\"?\"+g.join(\"&\")}})),o.default.sleep(u),$.ajax({url:r.apiUrl+l,type:r.apiMethod||\"GET\",success:function(t){var n=r.succFlag.split(\":\");if(null==t[n[0]]){var o=Object.assign({},{version:a.app_version,msg:\"setPlugCookie.js->data[success_flag[0]](line:225)->data:\"+JSON.stringify(t)+\"   ->success_flag:\"+n+\"  ->apiUrl:\"+r.apiUrl});$.ajax({url:i.moli_host+\"/spider/exception.wb\",type:\"POST\",headers:e.head,data:o,success:function(e){console.log(\"has error :  +\",r.apiUrl)}})}else if(t[n[0]].toString()==$.trim(n[1])){var u={};$.each(r.fields,function(e,r){if(r.dataRoot){var a=r.dataRoot.split(\".\"),n=r.fields.split(\"|\"),o=null;if(\"entity\"===r.dataType){for(var i=0;i<a.length;i++)o=o?o[a[i]]:t[a[i]];$.each(n,function(e,r){var t=r.split(\":\"),a=o;u[t[1]]=a[t[0]]})}else if(\"list\"===r.dataType){u[r.backArg]=new Array;for(var s=null,l=0;l<a.length;l++)s=s?s[a[l]]:t[a[l]];var c=s;c&&0<c.length&&c.forEach(function(e,t){var a={};$.each(n,function(r,t){var n=t.split(\":\");a[n[1]]=e[\"\"+n[0]]}),u[r.backArg].push(a)})}else u[r.dataField]=t[r.dataField]}else u[r.dataField]=t[r.dataField]});var l=u;if(c[s][\"Content-Type\"]&&(l=JSON.stringify(l)),Object.keys(l).length&&$.ajax({url:r.serviceUrl,type:\"POST\",async:!0,tiem:2300,headers:c[s],data:l,success:function(e){}}),p){for(var g=p.totalField.split(\".\"),v=null,h=0;h<g.length;h++)v=v?v[g[h]]:t[g[h]];var m=parseInt((parseInt(v)+parseInt(p.pageSize)-1)/parseInt(p.pageSize));if(!f)for(var y=2;y<=m;y++)d(y,!0)}}}});case 4:case\"end\":return t.stop()}},t,this)})),function(){return f.apply(this,arguments)});d()})})})},function(e,r,t){\"use strict\";Object.defineProperty(r,\"__esModule\",{value:!0}),r.default={$http:function(e,r){return new Promise(function(t,a){var n=new XMLHttpRequest;n.open(e,r,!0),n.onreadystatechange=function(){if(4==n.readyState){var e=JSON.parse(n.responseText);t(e)}},n.send()})},sleep:function(e){for(var r=new Date,t=r.getTime()+e;;)if((r=new Date).getTime()>t)return}}},function(e,r,t){\"use strict\";Object.defineProperty(r,\"__esModule\",{value:!0}),r.frontEndHost=r.moli_host=r.versionObj=void 0;var a,n=(a=t(0))&&a.__esModule?a:{default:a};r.versionObj=function(){return new Promise(function(e,r){$.ajax({url:i+\"/spider/checkUpdate.wb?vs=1\",success:function(r){e(r)},faile:function(e){r(e)}})})};var o,i=void 0;r.moli_host=i=n.default.backEndHost_dev,r.frontEndHost=o=n.default.tbPlatform,r.moli_host=i,r.frontEndHost=o}]);","extractedComments":[]}